"use client";

import Link from "next/link";
import { useQuery } from "convex/react";
import { api } from "@/convex/_generated/api";
import { Button } from "@/components/ui/button";
import { PromptCard } from "@/components/prompt-card";
import { Clock, Heart, TrendingUp, Sparkles, BarChart3 } from "lucide-react";

export default function Home() {
  const categories = useQuery(api.categories.getAllCategories);
  const popularPrompts = useQuery(api.prompts.getPublicPrompts, {
    limit: 6,
    sortBy: "popular",
  });
  const recentPrompts = useQuery(api.prompts.getPublicPrompts, {
    limit: 3,
    sortBy: "recent",
  });
  
  // „Ç´„ÉÜ„Ç¥„É™Âà•„ÅÆ„Éó„É≠„É≥„Éó„Éà„ÇíÂèñÂæó
  const entertainmentPrompts = useQuery(api.prompts.getPublicPrompts, {
    limit: 4,
    categoryId: categories?.find(c => c.slug === "entertainment")?._id,
    sortBy: "popular",
  });
  const assistantPrompts = useQuery(api.prompts.getPublicPrompts, {
    limit: 4,
    categoryId: categories?.find(c => c.slug === "assistant")?._id,
    sortBy: "popular",
  });
  
  const totalPrompts = popularPrompts?.length || 0;

  return (
    <main className="min-h-screen clean-bg">
      {/* Hero Section */}
      <section className="section-spacing">
        <div className="container-standard text-center">
          <h1 className="mb-6 text-5xl font-bold animate-fade-in text-pop">
            AI„Ç≠„É£„É©„ÇØ„Çø„Éº„Éó„É≠„É≥„Éó„ÉàÂÖ±Êúâ„Çµ„Éº„Éì„Çπ
          </h1>
          <p className="mb-8 text-xl text-muted-foreground animate-slide-up">
            AI„Å´„Ç≠„É£„É©„ÇØ„Çø„Éº„Å´„Å™„Çä„Åç„Å£„Å¶„ÇÇ„Çâ„ÅÜ„Åü„ÇÅ„ÅÆ„Éó„É≠„É≥„Éó„Éà„Çí‰ΩúÊàê„ÉªÂÖ±Êúâ„Åó„Çà„ÅÜ
          </p>
          <div className="flex gap-4 justify-center animate-bounce-subtle">
            <Link href="/prompts/new">
              <Button size="lg" className="btn-pop">„Éó„É≠„É≥„Éó„Éà„Çí‰ΩúÊàê</Button>
            </Link>
            <Link href="/explore">
              <Button size="lg" variant="outline" className="btn-secondary-pop">
                „Éó„É≠„É≥„Éó„Éà„ÇíÊé¢„Åô
              </Button>
            </Link>
          </div>
        </div>
      </section>

      {/* Stats Section */}
      <section className="py-8 border-y border-border/50">
        <div className="container-standard">
          <div className="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
            <div className="animate-fade-in">
              <div className="flex items-center justify-center gap-2 mb-2">
                <BarChart3 className="h-5 w-5 text-primary" />
                <h3 className="text-3xl font-bold">{totalPrompts * 10}+</h3>
              </div>
              <p className="text-muted-foreground">‰ΩúÊàê„Åï„Çå„Åü„Éó„É≠„É≥„Éó„Éà</p>
            </div>
            <div className="animate-fade-in" style={{animationDelay: "0.1s"}}>
              <div className="flex items-center justify-center gap-2 mb-2">
                <Heart className="h-5 w-5 text-pink-500" />
                <h3 className="text-3xl font-bold">{totalPrompts * 50}+</h3>
              </div>
              <p className="text-muted-foreground">Á¥ØË®à„ÅÑ„ÅÑ„Å≠Êï∞</p>
            </div>
            <div className="animate-fade-in" style={{animationDelay: "0.2s"}}>
              <div className="flex items-center justify-center gap-2 mb-2">
                <Sparkles className="h-5 w-5 text-yellow-500" />
                <h3 className="text-3xl font-bold">50+</h3>
              </div>
              <p className="text-muted-foreground">„Ç¢„ÇØ„ÉÜ„Ç£„Éñ„ÇØ„É™„Ç®„Ç§„Çø„Éº</p>
            </div>
          </div>
        </div>
      </section>

      {/* Popular Prompts Section */}
      <section className="section-spacing">
        <div className="container-standard">
          <div className="flex items-center justify-between mb-8">
            <div>
              <h2 className="text-3xl font-bold flex items-center gap-2">
                <TrendingUp className="h-8 w-8 text-primary" />
                ‰∫∫Ê∞ó„ÅÆ„Éó„É≠„É≥„Éó„Éà
              </h2>
              <p className="text-muted-foreground mt-2">‰ªäÊ≥®ÁõÆ„Åï„Çå„Å¶„ÅÑ„Çã„Ç≠„É£„É©„ÇØ„Çø„Éº„Éó„É≠„É≥„Éó„Éà</p>
            </div>
            <Link href="/explore?sort=popular">
              <Button variant="outline" className="btn-secondary-pop">
                „ÇÇ„Å£„Å®Ë¶ã„Çã
              </Button>
            </Link>
          </div>
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 grid-standard">
            {popularPrompts?.map((prompt) => (
              <PromptCard key={prompt._id} prompt={prompt} />
            ))}
          </div>
        </div>
      </section>

      {/* Category Highlights Section */}
      <section className="section-spacing">
        <div className="container-standard">
          <h2 className="mb-12 text-3xl font-bold text-center">„Ç´„ÉÜ„Ç¥„É™Âà•‰∫∫Ê∞ó„Éó„É≠„É≥„Éó„Éà</h2>
          
          {/* „Ç®„É≥„Çø„Éº„ÉÜ„Ç§„É°„É≥„Éà„Ç´„ÉÜ„Ç¥„É™ */}
          {entertainmentPrompts && entertainmentPrompts.length > 0 && (
            <div className="mb-12">
              <div className="flex items-center justify-between mb-6">
                <h3 className="text-2xl font-semibold flex items-center gap-2">
                  <span className="text-3xl">üé≠</span>
                  „Ç®„É≥„Çø„Éº„ÉÜ„Ç§„É°„É≥„Éà
                </h3>
                <Link href="/categories/entertainment">
                  <Button variant="ghost" size="sm">
                    „ÇÇ„Å£„Å®Ë¶ã„Çã ‚Üí
                  </Button>
                </Link>
              </div>
              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                {entertainmentPrompts.map((prompt) => (
                  <PromptCard key={prompt._id} prompt={prompt} />
                ))}
              </div>
            </div>
          )}
          
          {/* „Ç¢„Ç∑„Çπ„Çø„É≥„Éà„Ç´„ÉÜ„Ç¥„É™ */}
          {assistantPrompts && assistantPrompts.length > 0 && (
            <div className="mb-12">
              <div className="flex items-center justify-between mb-6">
                <h3 className="text-2xl font-semibold flex items-center gap-2">
                  <span className="text-3xl">üíº</span>
                  „Ç¢„Ç∑„Çπ„Çø„É≥„Éà
                </h3>
                <Link href="/categories/assistant">
                  <Button variant="ghost" size="sm">
                    „ÇÇ„Å£„Å®Ë¶ã„Çã ‚Üí
                  </Button>
                </Link>
              </div>
              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                {assistantPrompts.map((prompt) => (
                  <PromptCard key={prompt._id} prompt={prompt} />
                ))}
              </div>
            </div>
          )}
          
          {/* „Ç´„ÉÜ„Ç¥„É™‰∏ÄË¶ß */}
          <div className="mt-16">
            <h3 className="mb-6 text-xl font-semibold text-center">„Åô„Åπ„Å¶„ÅÆ„Ç´„ÉÜ„Ç¥„É™</h3>
            <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
              {categories?.map((category) => (
                <Link
                  key={category._id}
                  href={`/categories/${category.slug}`}
                  className="group"
                >
                  <div className="card-pop p-4 text-center hover:scale-105 transition-transform">
                    <div className="mb-2 text-3xl">{category.icon}</div>
                    <h4 className="text-sm font-medium group-hover:text-primary">
                      {category.name}
                    </h4>
                  </div>
                </Link>
              ))}
            </div>
          </div>
        </div>
      </section>

      {/* Recent Prompts Section */}
      <section className="section-spacing bg-muted/30">
        <div className="container-standard">
          <div className="flex items-center justify-between mb-8">
            <div>
              <h2 className="text-3xl font-bold flex items-center gap-2">
                <Clock className="h-8 w-8 text-primary" />
                ÊúÄÊñ∞„ÅÆ„Éó„É≠„É≥„Éó„Éà
              </h2>
              <p className="text-muted-foreground mt-2">Êñ∞„Åó„ÅèËøΩÂä†„Åï„Çå„Åü„Éó„É≠„É≥„Éó„Éà</p>
            </div>
            <Link href="/explore?sort=recent">
              <Button variant="outline" className="btn-secondary-pop">
                „ÇÇ„Å£„Å®Ë¶ã„Çã
              </Button>
            </Link>
          </div>
          <div className="grid grid-cols-1 md:grid-cols-3 grid-standard">
            {recentPrompts?.map((prompt) => (
              <PromptCard key={prompt._id} prompt={prompt} />
            ))}
          </div>
        </div>
      </section>

      {/* Features Section */}
      <section className="bg-muted/50 py-16 px-4">
        <div className="mx-auto max-w-6xl">
          <h2 className="mb-12 text-3xl font-bold text-center">
            Character Bank„ÅÆÁâπÂæ¥
          </h2>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
            <FeatureCard
              icon="üé≠"
              title="Â§öÂΩ©„Å™„Ç≠„É£„É©„ÇØ„Çø„Éº"
              description="ÁßòÊõ∏„ÄÅ„Ç®„É≥„Çø„Éº„ÉÜ„Ç§„Éä„Éº„ÄÅÊïôÂ∏´„Å™„Å©„ÄÅÊßò„ÄÖ„Å™„Ç≠„É£„É©„ÇØ„Çø„Éº„ÅÆ„Éó„É≠„É≥„Éó„Éà„ÇíÊé¢„Åõ„Åæ„Åô"
            />
            <FeatureCard
              icon="üöÄ"
              title="Á∞°ÂçòÂÖ±Êúâ"
              description="‰ΩúÊàê„Åó„Åü„Éó„É≠„É≥„Éó„Éà„Çí„ÉØ„É≥„ÇØ„É™„ÉÉ„ÇØ„Åß„Ç≥„Éî„Éº„ÄÇ„Åô„Åê„Å´AI„ÅßË©¶„Åõ„Åæ„Åô"
            />
            <FeatureCard
              icon="üí°"
              title="„Ç≥„Éü„É•„Éã„ÉÜ„Ç£"
              description="‰ªñ„ÅÆ„É¶„Éº„Ç∂„Éº„Åå‰ΩúÊàê„Åó„ÅüÂâµÈÄ†ÁöÑ„Å™„Éó„É≠„É≥„Éó„Éà„Åã„ÇâÂ≠¶„Å≥„ÄÅ„Ç§„É≥„Çπ„Éî„É¨„Éº„Ç∑„Éß„É≥„ÇíÂæó„Åæ„Åó„Çá„ÅÜ"
            />
          </div>
        </div>
      </section>

      {/* CTA Section */}
      <section className="py-20 px-4">
        <div className="mx-auto max-w-3xl text-center">
          <h2 className="mb-4 text-3xl font-bold">
            ‰ªä„Åô„ÅêÂßã„ÇÅ„Çà„ÅÜ
          </h2>
          <p className="mb-8 text-lg text-muted-foreground">
            „Ç¢„Ç´„Ç¶„É≥„Éà„Çí‰ΩúÊàê„Åó„Å¶„ÄÅ„ÅÇ„Å™„Åü„ÅÆ„Ç™„É™„Ç∏„Éä„É´„Ç≠„É£„É©„ÇØ„Çø„Éº„ÇíÂÖ±Êúâ„Åó„Åæ„Åó„Çá„ÅÜ
          </p>
          <Link href="/sign-up">
            <Button size="lg">ÁÑ°Êñô„ÅßÂßã„ÇÅ„Çã</Button>
          </Link>
        </div>
      </section>
    </main>
  );
}

function FeatureCard({
  icon,
  title,
  description,
}: {
  icon: string;
  title: string;
  description: string;
}) {
  return (
    <div className="text-center">
      <div className="mb-4 text-5xl">{icon}</div>
      <h3 className="mb-2 text-xl font-semibold">{title}</h3>
      <p className="text-muted-foreground">{description}</p>
    </div>
  );
}